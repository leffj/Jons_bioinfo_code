inFP = '/Users/leffj/software/Jons_bioinfo_code/test_gc.txt'
input = read.table(inFP,header=FALSE,sep='\t',comment.char="")
View(input)
input[,3]
means = tapply(input[,3],INDEX=input[,1],FUN=mean)
means
stds = tapply(input[,3],INDEX=input[,1],FUN=sd)
stds
smry = data.frame(means,stds)
smry
inFP = '/Users/leffj/software/Jons_bioinfo_code/test_gc.txt'
input = read.table(inFP,header=FALSE,sep='\t',comment.char="")
View(input)
class(input$V1)
class(input$V2)
class(input$V3)
classes = c('string','integer','numeric')
input = read.table(inFP,header=FALSE,sep='\t',comment.char="")
input = read.table(inFP,header=FALSE,sep='\t',colClasses=classes,comment.char="")
classes = c('character','integer','numeric')
input = read.table(inFP,header=FALSE,sep='\t',colClasses=classes,comment.char="")
library(vegan)
library(ggplot2)
inDis.B = '/Users/leffj/Dropbox/homes-1000/16S/test_comb_DSs/output/beta_div/sqrt-bray-5500.txt'
inDis = read.table(inDis.B,header=TRUE,row.names=1,sep='\t',check.names=FALSE,comment.char="")
map_fp = '/Users/leffj/Dropbox/homes-1000/metadata.csv'
# map = read.table(file=map_fp,header=T,sep='\t',row.names=1,check.names=F,comment.char='')
map = read.csv(map_fp,check.names=F,row.names=1)
# random subset
rand = sample(1:nrow(map),300,replace=F)
map = map[rand,]
map = read.csv(map_fp,check.names=F,row.names=1)
samplesToUse = intersect(row.names(map),row.names(inDis))
data.dm.use = inDis[match(samplesToUse,row.names(inDis)),match(samplesToUse,names(inDis))]
map.use = map[match(samplesToUse,row.names(map)),]
#format dm
distMat = as.dist(data.dm.use)
## Make an NMDS plot
mds = metaMDS(distMat,k=2)
factorColor = map.use$seq_run
factorShape = map.use$sample_type
ggplot(as.data.frame(mds$points),aes(x=MDS1,y=MDS2,color=factorShape)) +
geom_point(na.rm=T,alpha=0.6,size=2) +
theme_bw() + scale_color_discrete('Sequencing run')
ggplot(as.data.frame(mds$points),aes(x=MDS1,y=MDS2,color=factorColor)) +
geom_point(na.rm=T,alpha=0.6,size=2) +
theme_bw() + scale_color_discrete('Sequencing run')
adonis(formula=data.dm.use~map.use$seq_run)
adonis(formula=data.dm.use~map.use$sample_site)
adonis(formula=data.dm.use~map.use$seq_run)
inDis.B = '/Users/leffj/Dropbox/homes-1000/16S/test_comb_DSs/control/output/beta_div/sqrt-bray-5500.txt'
inDis = read.table(inDis.B,header=TRUE,row.names=1,sep='\t',check.names=FALSE,comment.char="")
inDis.B = '/Users/leffj/Dropbox/homes-1000/16S/test_comb_DSs/control/output/beta_div/sqrt_bray_5500.txt'
inDis = read.table(inDis.B,header=TRUE,row.names=1,sep='\t',check.names=FALSE,comment.char="")
# inDis.F = '/Users/leffj/Dropbox/homes-1000/ITS/output/beta_div/sqrt_bray_10000.txt'
# inDis = read.table(inDis.F,header=TRUE,row.names=1,sep='\t',check.names=FALSE,comment.char="")
# import mapping file
map_fp = '/Users/leffj/Dropbox/homes-1000/metadata.csv'
# map = read.table(file=map_fp,header=T,sep='\t',row.names=1,check.names=F,comment.char='')
map = read.csv(map_fp,check.names=F,row.names=1)
# random subset
# rand = sample(1:nrow(map),300,replace=F)
# map = map[rand,]
#make sure order/samples line up
samplesToUse = intersect(row.names(map),row.names(inDis))
data.dm.use = inDis[match(samplesToUse,row.names(inDis)),match(samplesToUse,names(inDis))]
map.use = map[match(samplesToUse,row.names(map)),]
#format dm
distMat = as.dist(data.dm.use)
## Make an NMDS plot
mds = metaMDS(distMat,k=2)
factorColor = map.use$seq_run
factorShape = map.use$sample_type
ggplot(as.data.frame(mds$points),aes(x=MDS1,y=MDS2,color=factorColor)) +
geom_point(na.rm=T,alpha=0.6,size=2) +
theme_bw() + scale_color_discrete('Sequencing run')
inDis.B = '/Users/leffj/Dropbox/homes-1000/16S/test_comb_DSs/output/beta_div_filt_control/sqrt_bray_4100.txt'
inDis = read.table(inDis.B,header=TRUE,row.names=1,sep='\t',check.names=FALSE,comment.char="")
# inDis.F = '/Users/leffj/Dropbox/homes-1000/ITS/output/beta_div/sqrt_bray_10000.txt'
# inDis = read.table(inDis.F,header=TRUE,row.names=1,sep='\t',check.names=FALSE,comment.char="")
# import mapping file
map_fp = '/Users/leffj/Dropbox/homes-1000/metadata.csv'
# map = read.table(file=map_fp,header=T,sep='\t',row.names=1,check.names=F,comment.char='')
map = read.csv(map_fp,check.names=F,row.names=1)
# random subset
# rand = sample(1:nrow(map),300,replace=F)
# map = map[rand,]
#make sure order/samples line up
samplesToUse = intersect(row.names(map),row.names(inDis))
data.dm.use = inDis[match(samplesToUse,row.names(inDis)),match(samplesToUse,names(inDis))]
map.use = map[match(samplesToUse,row.names(map)),]
#format dm
distMat = as.dist(data.dm.use)
## Make an NMDS plot
mds = metaMDS(distMat,k=2)
factorColor = map.use$seq_run
factorShape = map.use$sample_type
ggplot(as.data.frame(mds$points),aes(x=MDS1,y=MDS2,color=factorColor)) +
geom_point(na.rm=T,alpha=0.6,size=2) +
theme_bw() + scale_color_discrete('Sequencing run')
inDis = '/Users/leffj/Dropbox/homes-1000/ITS/test_comb_DSs/output/beta_div/sqrt_bray_10000.txt'
inDis = read.table(inDis,header=TRUE,row.names=1,sep='\t',check.names=FALSE,comment.char="")
map_fp = '/Users/leffj/Dropbox/homes-1000/metadata.csv'
# map = read.table(file=map_fp,header=T,sep='\t',row.names=1,check.names=F,comment.char='')
map = read.csv(map_fp,check.names=F,row.names=1)
# random subset
# rand = sample(1:nrow(map),300,replace=F)
# map = map[rand,]
#make sure order/samples line up
samplesToUse = intersect(row.names(map),row.names(inDis))
data.dm.use = inDis[match(samplesToUse,row.names(inDis)),match(samplesToUse,names(inDis))]
map.use = map[match(samplesToUse,row.names(map)),]
#format dm
distMat = as.dist(data.dm.use)
## Make an NMDS plot
mds = metaMDS(distMat,k=2)
factorColor = map.use$seq_run
factorShape = map.use$sample_type
ggplot(as.data.frame(mds$points),aes(x=MDS1,y=MDS2,color=factorColor)) +
geom_point(na.rm=T,alpha=0.6,size=2) +
theme_bw() + scale_color_discrete('Sequencing run')
adonis(formula=data.dm.use~map.use$seq_run)
inDis = '/Users/leffj/Dropbox/homes-1000/ITS/test_comb_DSs/control/beta_div/sqrt_bray_10000.txt'
inDis = read.table(inDis,header=TRUE,row.names=1,sep='\t',check.names=FALSE,comment.char="")
map_fp = '/Users/leffj/Dropbox/homes-1000/metadata.csv'
# map = read.table(file=map_fp,header=T,sep='\t',row.names=1,check.names=F,comment.char='')
map = read.csv(map_fp,check.names=F,row.names=1)
# random subset
# rand = sample(1:nrow(map),300,replace=F)
# map = map[rand,]
#make sure order/samples line up
samplesToUse = intersect(row.names(map),row.names(inDis))
data.dm.use = inDis[match(samplesToUse,row.names(inDis)),match(samplesToUse,names(inDis))]
map.use = map[match(samplesToUse,row.names(map)),]
#format dm
distMat = as.dist(data.dm.use)
## Make an NMDS plot
mds = metaMDS(distMat,k=2)
factorColor = map.use$seq_run
factorShape = map.use$sample_type
ggplot(as.data.frame(mds$points),aes(x=MDS1,y=MDS2,color=factorColor)) +
geom_point(na.rm=T,alpha=0.6,size=2) +
theme_bw() + scale_color_discrete('Sequencing run')
adonis(formula=data.dm.use~map.use$seq_run)
inDis.B = '/Users/leffj/Dropbox/homes-1000/16S/test_comb_DSs/output/beta_div/sqrt-bray-5500.txt'
inDis = read.table(inDis.B,header=TRUE,row.names=1,sep='\t',check.names=FALSE,comment.char="")
map_fp = '/Users/leffj/Dropbox/homes-1000/metadata.csv'
# controls
map_fp = '/Users/leffj/Dropbox/homes-1000/16S/Homes_16S_controls_all-runs.txt'
# map = read.table(file=map_fp,header=T,sep='\t',row.names=1,check.names=F,comment.char='')
map = read.csv(map_fp,check.names=F,row.names=1)
# random subset
# rand = sample(1:nrow(map),300,replace=F)
# map = map[rand,]
#make sure order/samples line up
samplesToUse = intersect(row.names(map),row.names(inDis))
data.dm.use = inDis[match(samplesToUse,row.names(inDis)),match(samplesToUse,names(inDis))]
map.use = map[match(samplesToUse,row.names(map)),]
#format dm
distMat = as.dist(data.dm.use)
## Make an NMDS plot
mds = metaMDS(distMat,k=2)
inDis.B = '/Users/leffj/Dropbox/homes-1000/16S/controls_analysis/beta_div/sqrt_bray_controls_2000.txt'
inDis = read.table(inDis.B,header=TRUE,row.names=1,sep='\t',check.names=FALSE,comment.char="")
map_fp = '/Users/leffj/Dropbox/homes-1000/16S/Homes_16S_controls_all-runs.txt'
# map = read.table(file=map_fp,header=T,sep='\t',row.names=1,check.names=F,comment.char='')
map = read.csv(map_fp,check.names=F,row.names=1)
# random subset
# rand = sample(1:nrow(map),300,replace=F)
# map = map[rand,]
#make sure order/samples line up
samplesToUse = intersect(row.names(map),row.names(inDis))
data.dm.use = inDis[match(samplesToUse,row.names(inDis)),match(samplesToUse,names(inDis))]
map.use = map[match(samplesToUse,row.names(map)),]
#format dm
distMat = as.dist(data.dm.use)
## Make an NMDS plot
mds = metaMDS(distMat,k=2)
inDis
map_fp
map
map = read.table(map_fp,header=T,sep='\t',row.names=1,check.names=F,comment.char='')
samplesToUse = intersect(row.names(map),row.names(inDis))
data.dm.use = inDis[match(samplesToUse,row.names(inDis)),match(samplesToUse,names(inDis))]
map.use = map[match(samplesToUse,row.names(map)),]
distMat = as.dist(data.dm.use)
## Make an NMDS plot
mds = metaMDS(distMat,k=2)
factorColor = map.use$seq_run
map.use
factorColor = map.use
ggplot(as.data.frame(mds$points),aes(x=MDS1,y=MDS2,color=factorColor)) +
geom_point(na.rm=T,alpha=0.6,size=2) +
theme_bw() + scale_color_discrete('Sequencing run')
pcoa = capscale(data.dm.use~1)
ggplot(as.data.frame(scores(pcoa)$sites),aes(x=MDS1,y=MDS2,color=factorColor)) +
geom_point(na.rm=T,alpha=0.6,size=2) +
theme_bw() + scale_color_discrete('Sample site')
map_fp = '/Users/leffj/Dropbox/homes-1000/16S/Homes_16S_controls_all-runs.txt'
map = read.table(map_fp,header=T,sep='\t',row.names=1,check.names=F,comment.char='')
#make sure order/samples line up
samplesToUse = intersect(row.names(map),row.names(inDis))
data.dm.use = inDis[match(samplesToUse,row.names(inDis)),match(samplesToUse,names(inDis))]
map.use = map[match(samplesToUse,row.names(map)),]
#format dm
distMat = as.dist(data.dm.use)
## Make an NMDS plot
mds = metaMDS(distMat,k=2)
factorColor = map.use
factorShape = map.use$type
ggplot(as.data.frame(mds$points),aes(x=MDS1,y=MDS2,color=factorColor,shape=factorShape)) +
geom_point(na.rm=T,alpha=0.6,size=2) +
theme_bw() + scale_color_discrete('Sequencing run')
factorShape
factorColor
factorColor = map.use$seq_run
factorShape = map.use$type
ggplot(as.data.frame(mds$points),aes(x=MDS1,y=MDS2,color=factorColor,shape=factorShape)) +
geom_point(na.rm=T,alpha=0.6,size=2) +
theme_bw() + scale_color_discrete('Sequencing run')
ggplot(as.data.frame(mds$points),aes(x=MDS1,y=MDS2,color=factorColor,shape=factorShape)) +
geom_point(na.rm=T,alpha=0.6,size=4) +
theme_bw() + scale_color_discrete('Sequencing run')
map = read.table(map_fp,header=T,sep='\t',row.names=1,check.names=F,comment.char='')
#make sure order/samples line up
samplesToUse = intersect(row.names(map),row.names(inDis))
data.dm.use = inDis[match(samplesToUse,row.names(inDis)),match(samplesToUse,names(inDis))]
map.use = map[match(samplesToUse,row.names(map)),]
#format dm
distMat = as.dist(data.dm.use)
## Make an NMDS plot
mds = metaMDS(distMat,k=2)
factorColor = map.use$seq_run
factorShape = map.use$lane
ggplot(as.data.frame(mds$points),aes(x=MDS1,y=MDS2,color=factorColor,shape=factorShape)) +
geom_point(na.rm=T,alpha=0.6,size=4) +
theme_bw() + scale_color_discrete('Sequencing run')
factorShape = factor(map.use$lane)
ggplot(as.data.frame(mds$points),aes(x=MDS1,y=MDS2,color=factorColor,shape=factorShape)) +
geom_point(na.rm=T,alpha=0.6,size=4) +
theme_bw() + scale_color_discrete('Sequencing run')
